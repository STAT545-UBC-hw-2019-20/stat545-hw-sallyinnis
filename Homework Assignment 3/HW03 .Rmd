---
title: 'cm006: `dplyr` Exercise'
output:
    html_document:
      keep_md: true
editor_options: 
  chunk_output_type: inline
---

```{r}
library(gapminder)
library(tidyverse)
library(dplyr)
library(DT)
library(reshape2)
```

# For each task chosen we need to produce: 
# A tibble, a graph and an explanation of data

# TASK 2
## Get the maximum and minimum of GDP per capita for all continents.

```{r}
task2 = gapminder %>% 
  group_by(continent) %>% 
  summarize(min_GDP = min(gdpPercap),
            max_GDP = max(gdpPercap))
  as_tibble(task2)
  
```


# TASK 5
## How is life expectancy changing over time on different continents?

```{r}
task5 = gapminder %>% 
  group_by(year, continent) %>% 
  summarize(meanlife = mean(lifeExp)) %>% 
  arrange(continent)
  as_tibble(task5)
```

```{r}
  ggplot(task5, aes(year, meanlife, colour = continent)) +
    geom_point() +
    geom_smooth(method = lm, se = FALSE) +
    xlab('Year') +
    ylab('Mean Life Expectancy')
```

### There has been a general increase in life expectancy in all continents. Asia has had the largest increase in mean life expectancy from 1952 - 2007.

# TASK 6
## Looking at population recovery in countries post genocide: Rwanda, Cambodia compared one country without.

```{r}
task6 = gapminder %>% 
  filter(country == 'Rwanda' | country == 'Cambodia' | country == 'Canada') %>% 
  group_by(country) %>% 
  arrange(country, year) %>% 
  mutate(pct_change = ((lifeExp/lag(lifeExp) - 1) * 100))
  as_tibble(task6)
```
```{r}
    ggplot(task6, aes(year, pct_change, colour = country)) +
    geom_line() +
    xlab('Year') +
    ylab('Percent Change in Life Expectancy')
```
### Population recovery post genocide displays the same trend in both Cambodia and Rwanda
